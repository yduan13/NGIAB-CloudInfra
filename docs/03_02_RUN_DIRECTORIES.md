# Model Run Directories

Running NextGen requires building a standard run directory complete with only the necessary files. This can be done automatically with the [Data Preprocess](/docs/products/ngiab/components/ngiab-preprocessor) tool.

Below is an explanation of NGIAB's format for model run directories.

### Root directory `ngen-run/`

An NGIAB run directory `ngen-run` contains the following subfolders:

- User-provided (required)
    - `config`:  model configuration files and hydrofabric configuration files.
- Generated by NGIAB
    - `forcings`: catchment-level forcing timeseries files. Forcing files contain variables like wind speed, temperature, precipitation, and solar radiation.
    - `metadata`: Programmatically generated folder used within ngen. Do not edit this folder.
    - `outputs`: This is where ngen will place the output files.
    - `restart`: For restart files. (optional)
    - `lakeout`: for t-route. (optional)
- Generated by TEEHR integration
    - `teehr`: Contains TEEHR-formatted output data.

```
ngen-run/
│
├── config/
│
├── forcings/
│
├── lakeout/
|
├── metadata/
│
├── outputs/
│
├── restart/
│
├── teehr/
```
 
### Configuration directory `ngen-run/config/`
This folder contains the NextGen realization file, which serves as the primary model configuration for the ngen framework. This file specifies which models to run (such as NoahOWP/CFE, LSTM, etc), run parameters like date and time, and hydrofabric specifications (like location, gage, catchment).

Based on the models defined in the realization file, [BMI](https://bmi.csdms.io/en/stable/index.html) configuration files may be required. For those models that require per-catchment configuration files, a folder will hold these files for each model in `ngen-run/config/cat-config`. See the directory structure convention below.

<!-- TODO: Provide instructions for linking arbitrary BMI models -->

```
ngen-run/
|
├── config/
|   │
|   ├── nextgen_09.gpkg
|   |
|   ├── realization.json
|   |
|   ├── ngen.yaml
|   |
|   ├── cat-config/
|   │   |
|   |   ├──PET/
|   │   |
|   |   ├──CFE/
|   │   |
|   |   ├──NOAH-OWP-M/
```

<!-- TODO: Subsections for each of these? -->

NextGen requires a single geopackage file. This file is the [hydrofabric (Johnson, 2022)](https://mikejohnson51.github.io/hyAggregate/) (spatial data). An example geopackage can be found on [Lynker-Spatial's website](https://www.lynker-spatial.com/data?path=hydrofabric%2Fv2.2%2F). Tools to subset a geopackage into a smaller domain can be found at [Lynker's hfsubset](https://github.com/LynkerIntel/hfsubset). 